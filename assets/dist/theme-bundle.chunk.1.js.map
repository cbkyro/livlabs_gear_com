{"version":3,"sources":["webpack:///./assets/js/theme/common/gift-certificate-validator.js","webpack:///./assets/js/theme/common/models/forms.js","webpack:///./assets/js/theme/gift-certificate.js"],"names":["cert","forms","email","value","re","test","password","notEmpty","length","GiftCertificate","context","$certBalanceForm","$","purchaseModel","recipientName","val","recipientEmail","formModel","senderName","senderEmail","customAmount","min","max","setAmount","options","found","forEach","option","$purchaseForm","$customAmounts","find","purchaseValidator","nod","submit","delay","$element","data","minFormatted","maxFormatted","add","selector","validate","cb","numberVal","Number","errorMessage","result","toName","toEmail","fromName","fromEmail","triggeredBy","certTheme","get","checked","agreeToTerms","balanceVal","checkCertBalanceValidator","on","performCheck","areAll","event","preventDefault","click","modal","defaultModal","previewUrl","currentTarget","serialize","open","api","getPage","err","content","updateContent","previewError","wrap","$balanceForm","balanceValidator","giftCertChecker"],"mappings":"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","file":"theme-bundle.chunk.1.js","sourcesContent":["export default function (cert) {\r\n    if (typeof cert !== 'string') {\r\n        return false;\r\n    }\r\n\r\n    // Add any custom gift certificate validation logic here\r\n    return true;\r\n}\r\n","const forms = {\r\n    email(value) {\r\n        const re = /^.+@.+\\..+/;\r\n        return re.test(value);\r\n    },\r\n\r\n    /**\r\n     * Validates a password field\r\n     * @param value\r\n     * @returns {boolean}\r\n     */\r\n    password(value) {\r\n        return this.notEmpty(value);\r\n    },\r\n\r\n    /**\r\n     * validates if a field is empty\r\n     * @param value\r\n     * @returns {boolean}\r\n     *\r\n     */\r\n    notEmpty(value) {\r\n        return value.length > 0;\r\n    },\r\n};\r\n\r\nexport default forms;\r\n","import PageManager from './page-manager';\r\nimport $ from 'jquery';\r\nimport nod from './common/nod';\r\nimport giftCertChecker from './common/gift-certificate-validator';\r\nimport formModel from './common/models/forms';\r\nimport { api } from '@bigcommerce/stencil-utils';\r\nimport { defaultModal } from './global/modal';\r\n\r\nexport default class GiftCertificate extends PageManager {\r\n    constructor(context) {\r\n        super(context);\r\n\r\n        const $certBalanceForm = $('#gift-certificate-balance');\r\n\r\n        const purchaseModel = {\r\n            recipientName(val) {\r\n                return val.length;\r\n            },\r\n            recipientEmail(...args) {\r\n                return formModel.email(...args);\r\n            },\r\n            senderName(val) {\r\n                return val.length;\r\n            },\r\n            senderEmail(...args) {\r\n                return formModel.email(...args);\r\n            },\r\n            customAmount(value, min, max) {\r\n                return value && value >= min && value <= max;\r\n            },\r\n            setAmount(value, options) {\r\n                let found = false;\r\n\r\n                options.forEach((option) => {\r\n                    if (option === value) {\r\n                        found = true;\r\n                        return false;\r\n                    }\r\n                });\r\n\r\n                return found;\r\n            },\r\n        };\r\n\r\n        const $purchaseForm = $('#gift-certificate-form');\r\n        const $customAmounts = $purchaseForm.find('input[name=\"certificate_amount\"]');\r\n        const purchaseValidator = nod({\r\n            submit: '#gift-certificate-form input[type=\"submit\"]',\r\n            delay: 300,\r\n        });\r\n\r\n        if ($customAmounts.length) {\r\n            const $element = $purchaseForm.find('input[name=\"certificate_amount\"]');\r\n            const min = $element.data('min');\r\n            const minFormatted = $element.data('minFormatted');\r\n            const max = $element.data('max');\r\n            const maxFormatted = $element.data('maxFormatted');\r\n\r\n            purchaseValidator.add({\r\n                selector: '#gift-certificate-form input[name=\"certificate_amount\"]',\r\n                validate: (cb, val) => {\r\n                    const numberVal = Number(val);\r\n\r\n                    if (!numberVal) {\r\n                        cb(false);\r\n                    }\r\n\r\n                    cb(numberVal >= min && numberVal <= max);\r\n                },\r\n                errorMessage: `You must enter a certificate amount between ${minFormatted} and ${maxFormatted}.`,\r\n            });\r\n        }\r\n\r\n        purchaseValidator.add([\r\n            {\r\n                selector: '#gift-certificate-form input[name=\"to_name\"]',\r\n                validate: (cb, val) => {\r\n                    const result = purchaseModel.recipientName(val);\r\n\r\n                    cb(result);\r\n                },\r\n                errorMessage: this.context.toName,\r\n            },\r\n            {\r\n                selector: '#gift-certificate-form input[name=\"to_email\"]',\r\n                validate: (cb, val) => {\r\n                    const result = purchaseModel.recipientEmail(val);\r\n\r\n                    cb(result);\r\n                },\r\n                errorMessage: this.context.toEmail,\r\n            },\r\n            {\r\n                selector: '#gift-certificate-form input[name=\"from_name\"]',\r\n                validate: (cb, val) => {\r\n                    const result = purchaseModel.senderName(val);\r\n\r\n                    cb(result);\r\n                },\r\n                errorMessage: this.context.fromName,\r\n            },\r\n            {\r\n                selector: '#gift-certificate-form input[name=\"from_email\"]',\r\n                validate: (cb, val) => {\r\n                    const result = purchaseModel.senderEmail(val);\r\n\r\n                    cb(result);\r\n                },\r\n                errorMessage: this.context.fromEmail,\r\n            },\r\n            {\r\n                selector: '#gift-certificate-form input[name=\"certificate_theme\"]:first-of-type',\r\n                triggeredBy: '#gift-certificate-form input[name=\"certificate_theme\"]',\r\n                validate: (cb) => {\r\n                    const val = $purchaseForm.find('input[name=\"certificate_theme\"]:checked').val();\r\n\r\n                    cb(typeof (val) === 'string');\r\n                },\r\n                errorMessage: this.context.certTheme,\r\n            },\r\n            {\r\n                selector: '#gift-certificate-form input[name=\"agree\"]',\r\n                validate: (cb) => {\r\n                    const val = $purchaseForm.find('input[name=\"agree\"]').get(0).checked;\r\n\r\n                    cb(val);\r\n                },\r\n                errorMessage: this.context.agreeToTerms,\r\n            },\r\n            {\r\n                selector: '#gift-certificate-form input[name=\"agree2\"]',\r\n                validate: (cb) => {\r\n                    const val = $purchaseForm.find('input[name=\"agree2\"]').get(0).checked;\r\n\r\n                    cb(val);\r\n                },\r\n                errorMessage: this.context.agreeToTerms,\r\n            },\r\n        ]);\r\n\r\n        if ($certBalanceForm.length) {\r\n            const balanceVal = this.checkCertBalanceValidator($certBalanceForm);\r\n\r\n            $certBalanceForm.on('submit', () => {\r\n                balanceVal.performCheck();\r\n\r\n                if (!balanceVal.areAll('valid')) {\r\n                    return false;\r\n                }\r\n            });\r\n        }\r\n\r\n        $purchaseForm.on('submit', event => {\r\n            purchaseValidator.performCheck();\r\n\r\n            if (!purchaseValidator.areAll('valid')) {\r\n                return event.preventDefault();\r\n            }\r\n        });\r\n\r\n        $('#gift-certificate-preview').click(event => {\r\n            event.preventDefault();\r\n\r\n            purchaseValidator.performCheck();\r\n\r\n            if (!purchaseValidator.areAll('valid')) {\r\n                return;\r\n            }\r\n\r\n            const modal = defaultModal();\r\n            const previewUrl = `${$(event.currentTarget).data('previewUrl')}&${$purchaseForm.serialize()}`;\r\n\r\n            modal.open();\r\n\r\n            api.getPage(previewUrl, {}, (err, content) => {\r\n                if (err) {\r\n                    return modal.updateContent(this.context.previewError);\r\n                }\r\n\r\n                modal.updateContent(content, { wrap: true });\r\n            });\r\n        });\r\n    }\r\n\r\n    checkCertBalanceValidator($balanceForm) {\r\n        const balanceValidator = nod({\r\n            submit: $balanceForm.find('input[type=\"submit\"]'),\r\n        });\r\n\r\n        balanceValidator.add({\r\n            selector: $balanceForm.find('input[name=\"giftcertificatecode\"]'),\r\n            validate(cb, val) {\r\n                cb(giftCertChecker(val));\r\n            },\r\n            errorMessage: 'You must enter a certificate code.',\r\n        });\r\n\r\n        return balanceValidator;\r\n    }\r\n}\r\n"],"sourceRoot":""}